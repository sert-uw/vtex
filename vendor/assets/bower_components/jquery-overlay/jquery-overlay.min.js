/* ========================================================================
 * jquery-overlay-v0.0.1 : Monday, 28.04.2014, 06:32:36
 * a Plugin for jQuery
 * Copyright 2014 Web-evolutions
 * ========================================================================
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 * 
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 * ======================================================================== */

!function(a,b){var c="overlay",d="plugin_"+c,e={cls:"overlay-layer",style:"display:none;",build:!0,content:"STAGE",template:function(a){return'<div class="overlay-stage">'+a+"</div>"},timein:500,timeout:500,close:!0,id:!1},f=1,g="data-overlay-id",h="data-overlay-target",i="data-overlay-type",j={},k=function(a,b,c){if(j[a].build===!0){var d=b.find("["+i+'="layer"]['+h+'="'+a+'"]');if(!d.length){var e=c.template(j[a].content);b.append("<div "+i+'="layer" '+h+'="'+a+'" class="'+j[a].cls+'" style="'+j[a].style+'">'+e+"</div>"),b.trigger("overlay.prepare")}}},l=function(b,c,d){var e=a("["+i+'="layer"]['+h+'="'+b+'"]');if(e.length)if("function"==typeof d)d(b,e,c);else{var f=j[b].template(j[b].content);e.html(f)}return e},m=function(a){var b={};return"object"==typeof a?"undefined"!=typeof a.overlayTarget?b[a.overlayTarget]=a.overlayTarget:"undefined"!=typeof a.overlayId?b[a.overlayId]=a.overlayId:b=a:b[a]=a,b},n=function(b){var c="";("undefined"!=typeof b.overlayId||"undefined"!=typeof b.overlayTarget)&&("undefined"!=typeof b.overlayId?c=b.overlayId:"undefined"!=typeof b.overlayTarget&&(c=b.overlayTarget),a.each(j[c],function(a){var d="overlay"+a.charAt(0).toUpperCase()+a.slice(1);"undefined"!=typeof b[d]&&(j[c][a]=b[d])}))},o=function(b,c,d,e){n(b,e),a.each(m(b),function(b,f){if(f in j){var g=a("["+i+'="layer"]['+h+'="'+f+'"]');e.content!==j[f].content&&l(f,d,j[f].content,e),"hide"===c&&g.fadeOut(j[f].timeout),"show"===c&&g.fadeIn(j[f].timein),d.trigger("overlay."+c)}})},p=function(b,c,d,e){a("["+c+'="'+d+'"]').on(e,function(){var c=a(this);"layer"!==d?c.overlay(b,c.data()):(closeOnClick=c.overlay("settings",c.data(),"get","close"),closeOnClick===!0&&c.overlay(b,c.data()))})},q=function(b){this.options=a.extend({},e),this.selector=a(b),this.element=b};q.prototype={init:function(b){a.extend(this.options,b);var c=this,d=0,e="",h="undefined";this.selector.trigger("overlay.init"),this.selector.each(function(){e=c.options.id===!1?f+"-"+d:c.options.id,h=c.selector.attr(g),"undefined"==typeof h?c.selector.attr(g,e):e=h,e in j||(j[e]={cls:c.options.cls,style:c.options.style,build:c.options.build,content:c.options.content,timein:c.options.timein,timeout:c.options.timeout,close:c.options.close,template:c.options.template},k(e,c.selector,c.options)),d++}),f++},hide:function(a){o(a,"hide",this.selector,this.options)},show:function(a){o(a,"show",this.selector,this.options)},content:function(b,c){var d=this;a.each(m(b),function(a,b){b in j&&(l(b,d.selector,c,d.options),d.selector.trigger("overlay.content"))})},settings:function(b,c,d,e){var f=this,g="";return a.each(m(b),function(a,b){b in j&&("get"===c&&"undefined"!=typeof d&&(g=j[b][d]),"set"===c&&"undefined"!=typeof d&&"undefined"!=typeof e&&(j[b][d]=e),f.selector.trigger("overlay."+c))}),g},destroy:function(){this.element.data(d,null)}},a.fn[c]=function(b){var e,f;if(this.data(d)instanceof q||this.data(d,new q(this)),f=this.data(d),null!==f)if(f.element=this,"undefined"==typeof b||"object"==typeof b)"function"==typeof f.init&&f.init(b);else{if("string"==typeof b&&"function"==typeof f[b])return e=Array.prototype.slice.call(arguments,1),f[b].apply(f,e);a.error("Method "+b+" does not exist on jQuery."+c)}},a("["+g+"]").each(function(){var b=a(this),c=b.attr(g);c in j||b.overlay(b.data())}),a(b).on("load",function(){p("show",i,"show","click"),p("hide",i,"hide","click"),p("hide",i,"layer","click")})}(jQuery,window,document);